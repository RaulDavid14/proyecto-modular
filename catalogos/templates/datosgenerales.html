{% extends 'navbar.html' %}

{% block titulo %}
<div class="text-center mt-4">
    <h1>Datos Generales</h1>
</div>
{% endblock titulo %}

{% block body %}
<div class="container my-5">
    <div class="card shadow-lg">
        <div class="card-body">
            <form id="datosForm" method="post" class="needs-validation">
                {% csrf_token %}
                
                <!-- Sección: Datos Personales -->
                <div class="card mb-4">
                    <div class="card-header bg-primary text-white">
                        <h5 class="mb-0">Datos Personales</h5>
                    </div>
                    
                    <div class="card-body">
                        <!-- Campo: Población -->
                        <div class="mb-4">
                            <h6>{{ form.poblacion.label }}</h6>
                            <select 
                                name="poblacion" 
                                id="{{ form.poblacion.auto_id }}" 
                                class="form-select form-control-sm" 
                                required
                            >
                                <option value="" disabled selected>--Selecciona una opción--</option>
                                {% for campo in form.poblacion %}
                                <option value="{{ campo.choice_value }}">
                                    {{ campo.choice_label }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>

                        <!-- Campo: Sexo -->
                        <div class="mb-4">
                            <h6>{{ form.sexo.label }}</h6>
                            <select 
                                name="sexo" 
                                id="{{ form.sexo.auto_id }}" 
                                class="form-select form-control-sm" 
                                required
                            >
                                <option value="" disabled selected>--Selecciona una opción--</option>
                                {% for campo in form.sexo %}
                                <option value="{{ campo.choice_value }}">
                                    {{ campo.choice_label }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <!-- Campo: Estado Civil -->
                        <div class="mb-4">
                            <h6>{{ form.estado_civil.label }}</h6>
                            <select 
                                name="estado_civil" 
                                id="{{ form.estado_civil.auto_id }}" 
                                class="form-select form-control-sm" 
                                required
                            >
                                <option value="" disabled selected>--Selecciona una opción--</option>
                                {% for campo in form.estado_civil %}
                                <option value="{{ campo.choice_value }}">
                                    {{ campo.choice_label }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                        
                        <!-- Campo: Nivel Educativo -->
                        <div class="mb-4">
                            <h6>{{ form.nivel_educativo.label }}</h6>
                            <select 
                                name="nivel_educativo" 
                                id="{{ form.nivel_educativo.auto_id }}" 
                                class="form-select form-control-sm" 
                                required
                            >
                                <option value="" disabled selected>--Selecciona una opción--</option>
                                {% for campo in form.nivel_educativo %}
                                <option value="{{ campo.choice_value }}">
                                    {{ campo.choice_label }}
                                </option>
                                {% endfor %}
                            </select>
                        </div>
                    </div>
                </div>

                <!-- Sección: Datos Socioeconómicos -->
                <div class="card mb-4">
                    <div class="card-header bg-success text-white">
                        <h5 class="mb-0">Datos Socioeconómicos</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <!-- Campo: Ingresos -->
                            <div class="col-md-6 mb-4">
                                <h6>{{ economico.ingresos.label }}</h6>
                                <select 
                                    name="ingresos" 
                                    id="{{ economico.ingresos.auto_id }}" 
                                    class="form-select form-control-sm" 
                                    required
                                >
                                    <option value="" disabled selected>--Selecciona una opción--</option>
                                    {% for campo in economico.ingresos %}
                                    <option value="{{ campo.choice_value }}">
                                        {{ campo.choice_label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>

                            <!-- Campo: Situación Laboral -->
                            <div class="col-md-6 mb-4">
                                <h6>{{ economico.situacion_laboral.label }}</h6>
                                <select 
                                    name="situacion_laboral" 
                                    id="{{ economico.situacion_laboral.auto_id }}" 
                                    class="form-select form-control-sm" 
                                    required
                                >
                                    <option value="" disabled selected>--Selecciona una opción--</option>
                                    {% for campo in economico.situacion_laboral %}
                                    <option value="{{ campo.choice_value }}">
                                        {{ campo.choice_label }}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Botón de Envío -->
                <div class="text-center">
                    <button type="submit" class="btn btn-primary btn-lg px-5">Enviar</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    // Validación personalizada con JavaScript
    document.getElementById('datosForm').addEventListener('submit', function(event) {
        const form = event.target;
        const selects = form.querySelectorAll('select');

        // Verifica si cada campo obligatorio tiene un valor seleccionado
        const isFormValid = Array.from(selects).every(select => select.value !== "");

        if (!isFormValid) {
            event.preventDefault(); // Detiene el envío del formulario
            alert('Debe seleccionar una opción válida en todos los campos.');
        }
    });
</script>
{% endblock body %}
